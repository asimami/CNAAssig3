#!/usr/bin/env python3

#Importing the needed python library for this assiginment.
import sys
import copy
from collections import defaultdict

INF = float('inf')

#Defining the Router class for the Distance Vector
class Router:
    # Creating the consturntion funciton for the routing class
    def __init__(self, router_name):
        self.router_name = router_name
        self.neighbors = {}
        self.routing_cost = {}
        self.distance_table = defaultdict(dict)
    
    # Creating the initialize_rotuer function that have two paprertmers self and router.
    def initialize_router(self, routers):
        # Usng the for loop to inisilize the distance table for all the destivnation throguh all neighbours.
        for destination_router in routers:
            for neighbors in routers:
                if neighbors != self.router_name:
                    self.distance_table[destination_router][neighbors] = INF

        # Usng the for loop to inizlise the routning cost to all the destioantion.
        for destination_router in routers:
            if destination_router == self.router_name:
                self.routing_cost[destination_router] = 0 #0 cost to reach to self.
            elif destination_router in self.neighbors:
                self.routing_cost[destination_router] = self.neighbors[destination_router]
            else: 
                self.routing_cost[destination_router] = INF
            
            for neighbors in self.neighbors:
                self.distance_table[destination_router][neighbors] = INF
        # Using the for loop to set the cost to each neighnbour that goes throguh itelsef.
        for neighbors in self.neighbors:
            self.distance_table[neighbors][neighbors] = self.neighbors[neighbors]

    # Creating the function with name updating_routing_cost which updates the routing cost everytime when find shortest path.
    def updating_routing_cost(self, router_network):
        table_updated = False #Putting the update false inisilly

        # Using the for loop to iterato over all the routers present in the network.
        for destination_router in router_network:
            if destination_router == self.router_name:
                continue
            # Inisliign the minmimum_cost anf tthe next hop
            minimum_cost = INF
            next_hop = None
            # Using the for loop to check the cost to reach the destination router via each neighbours present in the network.
            for neighbors in self.neighbors:
                cost_to_reach_neighbor = self.neighbors[neighbors]
                cost_coming_from_neighbor = router_network[router_network].routing_cost.get(destination_router, INF)
                final_cost = cost_to_reach_neighbor + cost_coming_from_neighbor
                self.distance_table[destination_router][neighbors] = final_cost
                # Using the if condition to cehck if the cost is better then previous cost.
                if final_cost < minimum_cost or (final_cost == minimum_cost and (next_hop is None or neighbors < next_hop)):
                    minimum_cost = final_cost
                    next_hop = neighbors
            # If the minimum cost is found update the cost in the tbale
            if self.routing_cost.get(destination_router, INF) != minimum_cost:
                self.routing_cost[destination_router] = minimum_cost
                table_updated = True # updating the table with new cost
        return table_updated #Returning the updated routing table after getting the new cost.